---
name: release

on:
  release:
    types:
      - created

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 1

      - name: set release version var
        run: |
          RELEASE_TAG=${{ github.ref_name }}
          RELEASE_VERSION=${RELEASE_TAG#v}

          echo "RELEASE_VERSION=$RELEASE_VERSION" >> "$GITHUB_ENV"

      - name: set version information
        run: |
          sed -i.bak -E "s|^(var Version = ).*|\1\"${{ env.RELEASE_VERSION }}\"|" constants/versions.go
          rm constants/versions.go.bak
